<!DOCTYPE html>
<html>
<head>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.6.10.min.js"></script>
    <script src="./app.js"></script>
    <script>
        function getHtml(template) {
            return template.join('\n');
        }
        listAlbums();




        function listAlbums() {

            //todo: need to do in safer way
           /* AWS.config.update({
                region: bucketRegion,
                credentials: new AWS.CognitoIdentityCredentials({
                    IdentityPoolId: IdentityPoolId
                })
            });*/

            AWS.config.update({accessKeyId: '', secretAccessKey: '', region: bucketRegion});


            var s3 = new AWS.S3({
                apiVersion: '2006-03-01',
                params: {Bucket: 'amipaces'}
            });

            s3.listObjects({Delimiter: '/'}, function(err, data) {
                if (err) {
                    return alert('There was an error listing your albums: ' + err.message);
                } else {
                    var albums = data.CommonPrefixes.map(function(commonPrefix) {
                        var prefix = commonPrefix.Prefix;
                        var albumName = decodeURIComponent(prefix.replace('/', ''));
                        return getHtml([
                            '<li>',
                            '<span onclick="deleteAlbum(\'' + albumName + '\')">X</span>',
                            '<span onclick="viewAlbum(\'' + albumName + '\')">',
                            albumName,
                            '</span>',
                            '</li>'
                        ]);
                    });
                    var message = albums.length ?
                        getHtml([
                            '<p>Click on an video to view it.</p>',
                            '<p>Click on the X to delete the video.</p>'
                        ]) :
                        '<p>You do not have any videos. Please Create video.';
                    var htmlTemplate = [
                        '<h2>videos</h2>',
                        message,
                        '<ul>',
                        getHtml(albums),
                        '</ul>',
                        '<button onclick="createAlbum(prompt(\'Enter video Name:\'))">',
                        'Create New video',
                        '</button>'
                    ]
                    document.getElementById('app').innerHTML = getHtml(htmlTemplate);
                }
            });
        }
    </script>
</head>
<body>
<h1>My S3 test App</h1>
<div id="app"></div>
<form method="post" action="upload" name="submit" enctype="multipart/form-data">
<input type="file" name="fileField"><br /><br />
<input type="submit" name="submit" value="Submit">
</form>
</body>
</html>

